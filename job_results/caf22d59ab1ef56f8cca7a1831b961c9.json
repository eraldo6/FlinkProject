{"jid":"caf22d59ab1ef56f8cca7a1831b961c9","name":"collect","isStoppable":false,"state":"FINISHED","start-time":1733326995079,"end-time":1733326997845,"duration":2766,"maxParallelism":-1,"now":1733327841647,"timestamps":{"FAILED":0,"RESTARTING":0,"FAILING":0,"FINISHED":1733326997845,"INITIALIZING":1733326995079,"RECONCILING":0,"CREATED":1733326995098,"SUSPENDED":0,"RUNNING":1733326995128,"CANCELLING":0,"CANCELED":0},"vertices":[{"id":"605b35e407e90cda15ad084365733fdd","name":"Source: customer[15]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326995234,"end-time":1733326995297,"duration":63,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":0,"read-bytes-complete":true,"write-bytes":1618,"write-bytes-complete":true,"read-records":0,"read-records-complete":true,"write-records":28,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":8,"accumulated-busy-time":7.0}},{"id":"1171dea6747ab509fdaefbe74f7195af","name":"Source: store[10] -> Calc[11]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326995236,"end-time":1733326995313,"duration":77,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":0,"read-bytes-complete":true,"write-bytes":322,"write-bytes-complete":true,"read-records":0,"read-records-complete":true,"write-records":12,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":16,"accumulated-busy-time":7.0}},{"id":"2fa5fc7df17f61cb0e1946288970d799","name":"Source: date_dim[2] -> Calc[3]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326995237,"end-time":1733326995667,"duration":430,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":0,"read-bytes-complete":true,"write-bytes":9147,"write-bytes-complete":true,"read-records":0,"read-records-complete":true,"write-records":365,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":338,"accumulated-busy-time":42.0}},{"id":"ba23f9e3080db303f0d9c2f8169a9c56","name":"MultipleInput[39] [Source: store_returns[20]] -> Calc[23] -> HashAggregate[24]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326995681,"end-time":1733326997078,"duration":1397,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":9147,"read-bytes-complete":true,"write-bytes":2033827,"write-bytes-complete":true,"read-records":365,"read-records-complete":true,"write-records":49605,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":959,"accumulated-busy-time":313.0}},{"id":"b1885c8eb62d60b8b1546e695d6e3513","name":"HashAggregate[26] -> Calc[27] -> HashAggregate[28]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326997080,"end-time":1733326997321,"duration":241,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":2033827,"read-bytes-complete":true,"write-bytes":268,"write-bytes-complete":true,"read-records":49605,"read-records-complete":true,"write-records":6,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":1,"accumulated-busy-time":172.0}},{"id":"1b78ffcb8f27ba1a57a64602e2681bd5","name":"MultipleInput[37] [Source: store_returns[1]] -> Calc[6] -> HashAggregate[7]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326995684,"end-time":1733326997476,"duration":1792,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":9147,"read-bytes-complete":true,"write-bytes":2053712,"write-bytes-complete":true,"read-records":365,"read-records-complete":true,"write-records":50090,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":1364,"accumulated-busy-time":321.0}},{"id":"93203cb3bb8789c962161e4393cd05cc","name":"MultipleInput[38] -> Calc[18]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326997480,"end-time":1733326997707,"duration":227,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":2055652,"read-bytes-complete":true,"write-bytes":820,"write-bytes-complete":true,"read-records":50130,"read-records-complete":true,"write-records":14,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":3,"accumulated-busy-time":134.0}},{"id":"f65e690731c29afb516c92c5255332b7","name":"MultipleInput[40] -> Calc[32] -> SortLimit[33]","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326997710,"end-time":1733326997817,"duration":107,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":1088,"read-bytes-complete":true,"write-bytes":186,"write-bytes-complete":true,"read-records":20,"read-records-complete":true,"write-records":4,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":5,"accumulated-busy-time":2.0}},{"id":"87cd195398d664b7f0ce8ddbff1a01ab","name":"SortLimit[35] -> Sink: Collect table sink","maxParallelism":1,"parallelism":1,"status":"FINISHED","start-time":1733326997819,"end-time":1733326997844,"duration":25,"tasks":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":1,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"metrics":{"read-bytes":186,"read-bytes-complete":true,"write-bytes":0,"write-bytes-complete":true,"read-records":4,"read-records-complete":true,"write-records":0,"write-records-complete":true,"accumulated-backpressured-time":0,"accumulated-idle-time":1,"accumulated-busy-time":4.0}}],"status-counts":{"FAILED":0,"RUNNING":0,"CREATED":0,"SCHEDULED":0,"DEPLOYING":0,"FINISHED":9,"INITIALIZING":0,"CANCELED":0,"CANCELING":0,"RECONCILING":0},"plan":{"jid":"caf22d59ab1ef56f8cca7a1831b961c9","name":"collect","type":"BATCH","nodes":[{"id":"87cd195398d664b7f0ce8ddbff1a01ab","parallelism":1,"operator":"","operator_strategy":"","description":"[35]:SortLimit(orderBy=[c_customer_id ASC], offset=[0], fetch=[100], global=[true])<br/>+- Sink: Collect table sink<br/>","inputs":[{"num":0,"id":"f65e690731c29afb516c92c5255332b7","ship_strategy":"GLOBAL","exchange":"blocking"}],"optimizer_properties":{}},{"id":"f65e690731c29afb516c92c5255332b7","parallelism":1,"operator":"","operator_strategy":"","description":"[40]:MultipleInput(readOrder=[0,1], members=[&#92;nHashJoin(joinType=[InnerJoin], where=[((ctr_store_sk = ctr_store_sk0) AND (ctr_total_return &gt; ($f1 * 1.2)))], select=[ctr_store_sk, ctr_total_return, c_customer_id, ctr_store_sk0, $f1], isBroadcast=[true], build=[left])&#92;n:- [#1] Exchange(distribution=[broadcast])&#92;n+- HashAggregate(isMerge=[true], groupBy=[ctr_store_sk], select=[ctr_store_sk, Final_AVG(sum$0, count$1) AS $f1])&#92;n   +- [#2] Exchange(distribution=[hash[ctr_store_sk]])&#92;n])<br/>+- [32]:Calc(select=[c_customer_id])<br/>   +- [33]:SortLimit(orderBy=[c_customer_id ASC], offset=[0], fetch=[100], global=[false])<br/>","inputs":[{"num":0,"id":"93203cb3bb8789c962161e4393cd05cc","ship_strategy":"BROADCAST","exchange":"blocking"},{"num":1,"id":"b1885c8eb62d60b8b1546e695d6e3513","ship_strategy":"HASH[ctr_store_sk]","exchange":"blocking"}],"optimizer_properties":{}},{"id":"93203cb3bb8789c962161e4393cd05cc","parallelism":1,"operator":"","operator_strategy":"","description":"[38]:MultipleInput(readOrder=[0,0,1], members=[&#92;nHashJoin(joinType=[InnerJoin], where=[(ctr_customer_sk = c_customer_sk)], select=[ctr_customer_sk, ctr_store_sk, ctr_total_return, c_customer_sk, c_customer_id], isBroadcast=[true], build=[right])&#92;n:- Calc(select=[ctr_customer_sk, ctr_store_sk, ctr_total_return])&#92;n:  +- NestedLoopJoin(joinType=[InnerJoin], where=[(s_store_sk = ctr_store_sk)], select=[ctr_customer_sk, ctr_store_sk, ctr_total_return, s_store_sk], build=[right])&#92;n:     :- HashAggregate(isMerge=[true], groupBy=[ctr_customer_sk, ctr_store_sk], select=[ctr_customer_sk, ctr_store_sk, Final_SUM(sum$0) AS ctr_total_return])&#92;n:     :  +- [#3] Exchange(distribution=[hash[ctr_customer_sk, ctr_store_sk]])&#92;n:     +- [#2] Exchange(distribution=[broadcast])&#92;n+- [#1] Exchange(distribution=[broadcast])&#92;n])<br/>+- [18]:Calc(select=[ctr_store_sk, ctr_total_return, c_customer_id])<br/>","inputs":[{"num":0,"id":"605b35e407e90cda15ad084365733fdd","ship_strategy":"BROADCAST","exchange":"blocking"},{"num":1,"id":"1171dea6747ab509fdaefbe74f7195af","ship_strategy":"BROADCAST","exchange":"blocking"},{"num":2,"id":"1b78ffcb8f27ba1a57a64602e2681bd5","ship_strategy":"HASH[ctr_customer_sk, ctr_store_sk]","exchange":"blocking"}],"optimizer_properties":{}},{"id":"605b35e407e90cda15ad084365733fdd","parallelism":1,"operator":"","operator_strategy":"","description":"[15]:TableSourceScan(table=[[default_catalog, default_database, customer, project=[c_customer_sk, c_customer_id], metadata=[]]], fields=[c_customer_sk, c_customer_id])<br/>","optimizer_properties":{}},{"id":"1171dea6747ab509fdaefbe74f7195af","parallelism":1,"operator":"","operator_strategy":"","description":"[10]:TableSourceScan(table=[[default_catalog, default_database, store, filter=[=(s_state, _UTF-16LE'TN':VARCHAR(2147483647) CHARACTER SET &quot;UTF-16LE&quot;)], project=[s_store_sk, s_state], metadata=[]]], fields=[s_store_sk, s_state])<br/>+- [11]:Calc(select=[s_store_sk], where=[(s_state = 'TN')])<br/>","optimizer_properties":{}},{"id":"b1885c8eb62d60b8b1546e695d6e3513","parallelism":1,"operator":"","operator_strategy":"","description":"[26]:HashAggregate(isMerge=[true], groupBy=[ctr_customer_sk, ctr_store_sk], select=[ctr_customer_sk, ctr_store_sk, Final_SUM(sum$0) AS ctr_total_return])<br/>+- [27]:Calc(select=[ctr_store_sk, ctr_total_return])<br/>   +- [28]:LocalHashAggregate(groupBy=[ctr_store_sk], select=[ctr_store_sk, Partial_AVG(ctr_total_return) AS (sum$0, count$1)])<br/>","inputs":[{"num":0,"id":"ba23f9e3080db303f0d9c2f8169a9c56","ship_strategy":"HASH[ctr_customer_sk, ctr_store_sk]","exchange":"blocking"}],"optimizer_properties":{}},{"id":"ba23f9e3080db303f0d9c2f8169a9c56","parallelism":1,"operator":"","operator_strategy":"","description":"[39]:MultipleInput(readOrder=[0,1], members=[&#92;nHashJoin(joinType=[InnerJoin], where=[(sr_returned_date_sk = d_date_sk)], select=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt, d_date_sk], isBroadcast=[true], build=[right])&#92;n:- Calc(select=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt], where=[sr_store_sk IS NOT NULL])&#92;n:  +- [#2] TableSourceScan(table=[[default_catalog, default_database, store_returns, filter=[IS NOT NULL(sr_store_sk)], project=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt], metadata=[]]], fields=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt])&#92;n+- [#1] Exchange(distribution=[broadcast])&#92;n]) [[20]:TableSourceScan(table=[[default_catalog, default_database, store_returns, filter=[IS NOT NULL(sr_store_sk)], project=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt], metadata=[]]], fields=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt])]<br/>+- [23]:Calc(select=[sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_return_amt])<br/>   +- [24]:LocalHashAggregate(groupBy=[ctr_customer_sk, ctr_store_sk], select=[ctr_customer_sk, ctr_store_sk, Partial_SUM(sr_return_amt) AS sum$0])<br/>","inputs":[{"num":0,"id":"2fa5fc7df17f61cb0e1946288970d799","ship_strategy":"BROADCAST","exchange":"blocking"}],"optimizer_properties":{}},{"id":"1b78ffcb8f27ba1a57a64602e2681bd5","parallelism":1,"operator":"","operator_strategy":"","description":"[37]:MultipleInput(readOrder=[1,0], members=[&#92;nHashJoin(joinType=[InnerJoin], where=[(sr_returned_date_sk = d_date_sk)], select=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt, d_date_sk], isBroadcast=[true], build=[right])&#92;n:- [#1] TableSourceScan(table=[[default_catalog, default_database, store_returns, project=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt], metadata=[]]], fields=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt])&#92;n+- [#2] Exchange(distribution=[broadcast])&#92;n]) [[1]:TableSourceScan(table=[[default_catalog, default_database, store_returns, project=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt], metadata=[]]], fields=[sr_returned_date_sk, sr_customer_sk, sr_store_sk, sr_return_amt])]<br/>+- [6]:Calc(select=[sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_return_amt])<br/>   +- [7]:LocalHashAggregate(groupBy=[ctr_customer_sk, ctr_store_sk], select=[ctr_customer_sk, ctr_store_sk, Partial_SUM(sr_return_amt) AS sum$0])<br/>","inputs":[{"num":0,"id":"2fa5fc7df17f61cb0e1946288970d799","ship_strategy":"BROADCAST","exchange":"blocking"}],"optimizer_properties":{}},{"id":"2fa5fc7df17f61cb0e1946288970d799","parallelism":1,"operator":"","operator_strategy":"","description":"[2]:TableSourceScan(table=[[default_catalog, default_database, date_dim, filter=[=(d_year, 2001)], project=[d_date_sk, d_year], metadata=[]]], fields=[d_date_sk, d_year])<br/>+- [3]:Calc(select=[d_date_sk], where=[(d_year = 2001)])<br/>","optimizer_properties":{}}]}}